<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset=utf-8>
		<meta name="viewport" content="width=620">
		<title>HTML5 Demo: postMessage (same domain)</title>

		<style>
		iframe {
			width: 100%;
			border: 2px solid #ccc;
		}
		</style>

		<script>
			//var win = document.getElementById("iframe").contentWindow;

			addEventListener('load', function() {
				var win = document.getElementById("iframe").contentWindow;

				document.getElementsByTagName('form')[0].addEventListener('submit', function (e) {
					if (e.preventDefault)
						e.preventDefault();

					win.postMessage(
						document.getElementById("message").value,
						"*"
					);

					// otherwise set the returnValue property of the original event to false (IE)
					e.returnValue = false;
					return false;
				});
			});
				
		</script>
	</head>

	<body>
		<section id="wrapper">
		<header>
			<h1>postMessage (same domain)</h1>
		</header>

		<article>
			<form>
				<p>
					<label for="message">Message</label> 
					<input type="text" name="message" value="my message" id="message" /> 
					<input type="submit" /> 
				</p>
		
				<h2>Target iframe:</h2>
				<iframe id="iframe" src="postmessage_inner.html"></iframe>
			</form>
		</article>

	</body>
</html>
